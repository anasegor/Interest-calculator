import sqlite3

#создание и заполнение таблиц БД со значениями ключевой ставки ЦБ
connection = sqlite3.connect('my_database.db')
cur = connection.cursor() 
cur.execute('''
CREATE TABLE IF NOT EXISTS DateRate (
id INTEGER PRIMARY KEY,
date TEXT NOT NULL,
rate REAL NOT NULL
)
''')

sql = 'INSERT INTO DateRate (date, rate) values(?, ?)'
data = [
    ('18-12-2023', 16),
('2023-10-30',	15),
('2023-09-18',	13),
('2023-08-15',	12),
('2023-07-24',	8.50),
('2022-09-19',	7.50),
('2022-07-25',	8),
('2022-06-14',	9.50),
('2022-05-27',	11),
('2022-05-04',	14),
('2022-04-11',	17),
('2022-02-28',	20),
('2022-02-14',	9.50),
('2021-12-20',	8.50),
('2021-10-25',	7.50),
('2021-09-13',	6.75),
('2021-07-26',	6.50),
('2021-06-15',	5.50),
('2021-04-26',	5),
('2021-03-22',	4.50),
('2020-07-27',	4.25),
('2020-06-22',	4.50),
('2020-04-27',	5.50),
('2020-02-10',	6),
('2019-12-16',	6.25),
('2019-10-28',	6.50),
('2019-09-09',	7),
('2019-07-29',	7.25),
('2019-06-17',	7.50),
('2018-12-17',	7.75),
('2018-09-17',	7.50),
('2018-03-26',	7.25),
('2018-02-12',	7.50),
('2017-12-18',	7.75),
('2017-10-30',	8.25),
('2017-09-18',	8.50),
('2017-06-19',	9),
('2017-05-02',	9.25),
('2017-03-27',	9.75),
('2016-09-19',	10),
('2016-08-01',	10.50)
]

cur.execute("""
delete FROM DateRate
 """)

with connection:
    connection.executemany(sql, data) 

connection.commit()
connection.close()